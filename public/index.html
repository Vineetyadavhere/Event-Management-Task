<!DOCTYPE html>
<html>
<head>
    <title>User Registration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Open Sans', sans-serif;

            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }




        h1 {
    color: #7373b0;
    font-weight: bold;
    text-align: center;
    margin-bottom: 20px;
    font-family: 'Open Sans', sans-serif;
}
        form {
            background-color: #fff; 
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            margin: 0 auto;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
        }
        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="submit"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border-radius: 3px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        input[type="submit"] {
            background-color: #4caf50; 
            color: white; 
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #45a049; 
        }
        #firstNameError {
            color: red;
            text-align: center;
        }
        #lastNameError {
            color: red;
            text-align: center;
        }
        #registeredError {
            color: red;
            text-align: center;
        }
        #emailError{
            color: red;
            text-align: center;
        }
        #passwordError{
            color: red;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- This is the form to register the super user (admin) with the validation -->
    <h1>Admin Registration</h1>
    <form id="registrationForm" action="/admin-register" method="POST">
        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" name="firstName"><br />
        <span id="firstNameError"></span>
        
        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" name="lastName"><br />
        <span id="lastNameError"></span>
        
        <label for="email">Email:</label>
        <input type="email" id="email" name="email"><br />
        <span id="emailError"></span>
        <span id ="registeredError"></span>

        
        <label for="password">Password:</label>
        <input type="password" id="password" name="password"><br />
        <span id="passwordError"></span>
        
        <input type="submit" value="Register">
        <p style="text-align: center;">Already have an account? <a href="/user-login.html" style="text-decoration: none; color: #4caf50;">Login</a></p>

        <p id="error"></p>
    </form>


<script>
    document.getElementById('registrationForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const firstName = document.getElementById('firstName').value;
        const lastName = document.getElementById('lastName').value;
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const firstNameError = document.getElementById('firstNameError');
        const lastNameError = document.getElementById('lastNameError');
        const emailError = document.getElementById('emailError');
        const passwordError = document.getElementById('passwordError');
        const newerrorElement = document.getElementById('registeredError');


        clearError(firstNameError);
        clearError(lastNameError);
        clearError(emailError);
        clearError(passwordError);

        if (!firstName) {
            displayError(firstNameError, 'First Name is required.');
        }

        if (!lastName) {
            displayError(lastNameError, 'Last Name is required.');
        }

        if (!email) {
            displayError(emailError, 'Email is required.');
        }

        if (!password) {
            displayError(passwordError, 'Password is required.');
        } else if (password.length < 6) {
            displayError(passwordError, 'Password must be at least 6 characters.');
        }

        if (firstName && lastName && email && password && password.length >= 6) {

    
  
            fetch('/admin-register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    firstName: firstName,
                    lastName: lastName,
                    email: email,
                    password: password
                })
            })
            .then(response => {
                if (response.status === 409) {
                    throw new Error('User already registered');
                }
                return response.json();
            })
            .catch(error => {
                if (error.message === 'User already registered') {
                    // alert('User already registered. Please log in.');
                    newerrorElement.innerText = 'Email already registered.';
                newerrorElement.style.display = 'block';

                } else {
                    window.location.href = '/user-login.html';
                }
            });
        }
    });

    function displayError(element, message) {
        element.innerText = message;
        element.style.display = 'block';
    }

    function clearError(element) {
        element.innerText = '';
        element.style.display = 'none';
    }
</script>

</body>
</html>
